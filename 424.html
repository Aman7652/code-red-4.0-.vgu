<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Send OTP Example</title>
    <script>
        async function sendOtp(phoneNumber) {
            const response = await fetch('http://localhost:3000/send-otp', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ phoneNumber }),
            });
            if (!response.ok) throw new Error('Failed to send OTP');
            return response.json();
        }

        document.addEventListener('DOMContentLoaded', () => {
            const sendOtpButton = document.getElementById('sendOtpButton');
            const phoneNumberInput = document.getElementById('phoneNumber');
            const messageElement = document.getElementById('message');

            sendOtpButton.addEventListener('click', async () => {
                const phoneNumber = phoneNumberInput.value.trim();
                if (!phoneNumber) {
                    messageElement.textContent = 'Please enter a valid phone number.';
                    return;
                }

                try {
                    const data = await sendOtp(phoneNumber);
                    messageElement.textContent = data.message;
                } catch (error) {
                    messageElement.textContent = error.message;
                }
            });
        });
    </script>
</head>
<body>
    <h1>Send OTP</h1>
    <input type="text" id="phoneNumber" placeholder="Enter your phone number" />
    <button id="sendOtpButton">Send OTP</button>
    <p id="message"></p>

    <script>
        const express = require('express');
        const bodyParser = require('body-parser');
        const twilio = require('twilio');
        const cors = require('cors');

        const app = express();
        const port = 3000;

        // Twilio credentials (replace these with your actual credentials)
        const accountSid = 'your_account_sid';
        const authToken = 'your_auth_token';
        const client = new twilio(accountSid, authToken);

        app.use(cors());
        app.use(bodyParser.json());

        app.post('/send-otp', (req, res) => {
            const { phoneNumber } = req.body;
            const otp = Math.floor(100000 + Math.random() * 900000); // Generate a 6-digit OTP

            client.messages.create({
                body: `Your OTP is: ${otp}`,
                to: phoneNumber,
                from: 'your_twilio_phone_number' // Your Twilio phone number
            })
            .then(message => {
                console.log(`OTP sent: ${message.sid}`);
                res.status(200).send({ success: true, message: 'OTP sent successfully!' });
            })
            .catch(error => {
                console.error('Error sending OTP:', error);
                res.status(500).send({ success: false, message: 'Failed to send OTP.' });
            });
        });

        app.listen(port, () => {
            console.log(`Server running at http://localhost:${port}`);
        });
    </script>
</body>
</html>
